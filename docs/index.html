<html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/css/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/css/theme/white.min.css">
    <style>
        .reveal section img {
            background: transparent;
            border: 0;
            box-shadow: 0 0 0;
        }


        .reveal blockquote {
            text-align: left;
            font-size: 25px;
            background: #f9f9f9;
            border-left: 10px solid #ccc;
            margin: 1.5em auto;
            padding: 0.5em 10px;
            quotes: "\201C""\201D""\2018""\2019";
        }
        .reveal blockquote:before {
            color: #ccc;
            content: open-quote;
            font-size: 4em;
            line-height: 0.1em;
            margin-right: 0.25em;
            vertical-align: -0.4em;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section data-markdown
                 data-separator="^\n\n\n"
                 data-separator-vertical="^\n\n">
            <script type="text/template">
                # pixel-pipeline
                understand the way the pixels renders in the browsers



                ## User Experience
                ###### the "jank" effect


                ### What is "Jank"?
                > Jank is any stuttering, juddering or just plain halting that users see when a site or app isn't keeping up with the refresh rate. Jank is the result of frames taking too long for a browser to make, and it negatively impacts your users and how they experience your site or app.
                > ###### [jankfree.org](http://www.jankfree.org)


                - Most of the devices today render there screen 60 frame per second (60 FPS  or 60Hz).
                - This means that every change on the screen need to in the interval of 16ms (1 second / 60 = 16.66ms).
                - when this isn't done you get the "jank" effect.
                ######lets look an [this](examples/jank-effect.html) example.


                - we can see that in order to 'sticky' the circle:
                    - the "h1" is "position: absolute".
                    - a javascript script need to calculate the position from the top.
                    - the script need to listen the "document.onscroll" event.
                ```css
                h1{
                        position: absolute;
                }
                ```
                ```js
                document.onscroll = function () {
                        document.querySelector('h1').style.top =
                            document.body.scrollTop + 'px';
                }
                ```


                when we remove the js section and change the
                ```
                 position: absolute;
                ```
                to
                ```
                position: fixed;
                ```
                the jank disappears.
                lets look an [this](examples/jank-effect-fixed.html) example.


                - This is a major jank that can be seen on small scale, most of the jank seen after abused the rendering system.
                - In this lecture we will discuss how to find and fix long frame rate that cause "jank".



                ## The Pixel Pipeline
                ##### The Way CSS/JS effect the rendering of the screen.


                ### Painting is actually two tasks:
                - Creating a list of draw calls.
                - Filling in the pixels.


                ### the complete pipeline is

                ![alt text](./images/JS-CSS_Style_Layout_Paint_Composite.png "pixel pipe line")


                ###JavaScript:
                Typically JavaScript is used to handle work that will result in visual changes.
                * JavaScript that triggers a visual change.
                * Css / Web, animations.
                * Add new element to the DOM.


                ###Style:
                This is the process of figuring out which CSS rules apply to which elements based on matching selectors.
                the computing time that take to get the element
                ```css
                    #main > div > div ul.first + ul {
                    }
                ```

                ```css
                    .main_div_div_ul_second {
                    }
                ```


                ###Layout:
                Once the browser knows which rules apply to an element it can begin to calculate how much space it takes up and where it is on screen.
                ```html
                <html>
                ...
                    <div style="margin-left:10px">
                        ...
                    </div>
                ...
                </html>
                ```

                ```html
                <html>
                ...
                    <div style="margin-left:100px">
                            ...
                    </div>
                ...
                </html>
                ```


                ###Paint:
                Painting is the process of filling in pixels.
                - Image change.
                - Font color change.


                ###Compositing:
                drawn to the screen in the correct order so that the page renders correctly.
                this is the z-index of the drawing.



                ##Effection the pipeline
                what the browser do when there is a new call for draw.


                ###Reflow:
                - when there is a change with the element height, weight or position in the page.
                - this will trigger all over the pipe line
                ![alt text](./images/JS-CSS_Style_Layout_Paint_Composite.png "pixel pipe line")
                - [Example](examples/reflow.html)


                ###Paint Only:
                - when there is a change in the element color, background or shadow.
                - the layout didn't change so expect of that the pipeline is the same.
                ![alt text](./images/JS-CSS_Style_Paint_Composite.png "pixel pipe line")
                - [Example](examples/paint.html)


                ###Composite:
                - when the change isn't effect the painting, like scrolling.
                - this is change jump directly to Composite
                ![alt text](./images/JS-CSS_Style_Composite.png "pixel pipe line")
                - [Example](examples/composite.html)


                ![alt text](./images/csstriggers.png "csstriggers.com")
                - Find the [pipeline effects](https://csstriggers.com/).



                ##javascript best practices
                ##### organize your javascript in line with the pipeline.


                ### from set-Timeout to request-Animation-Frame
                - setTimeout start at any time on the frame
                - requestAnimationFrame start at the beginning of the frame
                - this way, when request or change a layout property, the request or change have more success to finish before the frame end.
                - that give a smoothed feeling for the user.


                ### working with web workers
                - calculating in javascript take a great deal of resources.
                - when the calculation take place in the main thread you may get the "jank" feeling.
                - by excel the hard computing to a web worker, the main thread is free to handle with the UI.
                - **BE CAREFUL**! export script that isn't effects the DOM.


                - the
            </script>
        </section>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/js/reveal.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/lib/js/head.min.js"></script>
<script>
    Reveal.initialize({
        history: true,
        slideNumber: true,
        dependencies: [
            {
                src: "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/plugin/markdown/marked.min.js",
                condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
            },
            {
                src: "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.3.0/plugin/markdown/markdown.min.js",
                condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
            }

        ]
    });
</script>
</body>
</html>